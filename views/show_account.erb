<% content_for :title do %>Détails du Compte<% end %>
<style>
  h1 {
    margin-bottom: 20px;
  }
  p {
    margin-bottom: 10px;
  }
  strong {
    font-weight: bold;
  }
  .account-details {
    margin-bottom: 20px;
    padding: 15px;
    border: 1px solid #ddd;
    background-color: #f9f9f9;
    border-radius: 5px;
  }
  h2 {
    margin-top: 20px;
    margin-bottom: 10px;
    color: #28a745;
  }
  form {
    padding: 15px;
    border: 1px solid #ddd;
    background-color: #f9f9f9;
    border-radius: 5px;
    margin-bottom: 15px;
  }
  label {
    display: block;
    margin-bottom: 5px;
    font-weight: bold;
  }
  input[type="number"] {
    width: calc(100% - 12px);
    padding: 8px;
    margin-bottom: 10px;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
  }
  button[type="submit"] {
    color: white;
    padding: 10px 15px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 1em;
  }
  button[type="submit"]:hover {
    opacity: 0.9;
  }
  button[type="submit"].deposit {
    background-color: #28a745; /* Vert pour déposer */
  }
  button[type="submit"].deposit:hover {
    background-color: #1e7e34;
  }
  button[type="submit"].withdraw {
    background-color: #007bff; /* Bleu pour retirer */
  }
  button[type="submit"].withdraw:hover {
    background-color: #0056b3;
  }
  button[type="submit"].deactivate {
    background-color: #dc3545; /* Rouge pour désactiver */
  }
  button[type="submit"].activate {
    background-color: #ffc107; /* Jaune pour activer */
    color: #333;
  }
  .inactive-message {
    color: orange;
    font-weight: bold;
  }
  a {
    color: #007bff;
    text-decoration: none;
  }
  a:hover {
    text-decoration: underline;
  }
  .operation-history {
    margin-top: 20px;
    padding: 15px;
    border: 1px solid #ddd;
    background-color: #f9f9f9;
    border-radius: 5px;
  }
  .operation-history h3 {
    margin-top: 0;
    color: #6c757d;
  }
  .operation-history ul {
    list-style: none;
    padding: 0;
  }
  .operation-history li {
    padding: 8px 0;
    border-bottom: 1px solid #eee;
  }
  .operation-history li:last-child {
    border-bottom: none;
  }
  .operation-history .timestamp {
    font-size: 0.8em;
    color: #777;
    margin-left: 10px;
  }
</style>
<h1>Détails du Compte</h1>
<% if @account %>
  <div class="account-details">
    <p><strong>ID:</strong> <%= @account.id %></p>
    <p><strong>Propriétaire:</strong> <a href="/users/<%= @account.owner.id %>"><%= @account.owner.name %></a></p>
    <p><strong>Solde:</strong> <%= @account.balance %></p>
    <p><strong>Statut:</strong> <span class="<%= @account.active? ? '' : 'inactive-message' %>"><%= @account.active? ? 'Actif' : 'Inactif' %></span></p>
  </div>

  <% if @account.active? %>
    <h2>Effectuer une Transaction</h2>
    <div>
      <h3>Dépôt</h3>
      <form action="/accounts/<%= @account.id %>/deposit" method="post">
        <label for="montant_depot">Montant:</label>
        <input type="number" id="montant_depot" name="amount" step="0.01" required>
        <button type="submit" class="deposit">Déposer</button>
      </form>
    </div>
    <div>
      <h3>Retrait</h3>
      <form action="/accounts/<%= @account.id %>/withdraw" method="post">
        <label for="montant_retrait">Montant:</label>
        <input type="number" id="montant_retrait" name="amount" step="0.01" required>
        <button type="submit" class="withdraw">Retirer</button>
      </form>
    </div>
    <form action="/accounts/<%= @account.id %>/deactivate" method="post">
      <button type="submit" class="deactivate">Désactiver le compte</button>
    </form>
  <% else %>
    <p class="inactive-message">Ce compte est désactivé. Aucune transaction n'est possible.</p>
    <form action="/accounts/<%= @account.id %>/activate" method="post">
      <button type="submit" class="activate">Activer le compte</button>
    </form>
  <% end %>

  <% if @account.operations && !@account.operations.empty? %>
    <div class="operation-history">
      <h3>Historique des Opérations</h3>
      <ul>
        <% @account.operations.reverse_each do |op| %>
          <li>
            <strong><%= op.type.capitalize %></strong> de <%= op.amount %>
            <span class="timestamp">le <%= op.created_at.strftime("%d/%m/%Y à %H:%M:%S") %></span>
          </li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <p><a href="/accounts">Retour à la liste des comptes</a></p>
<% else %>
  <p class="error"><%= @error %></p>
<% end %>
<p><a href="/">Retour</a></p>